/**
 * Copyright 2026 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@use "../../common.scss" as common;
@use "@angular/material" as mat;

$text-color-primary: #333;
$font-weight-semibold: 600;
$font-weight-light: 300;

@mixin dashed-border($dash-size, $gap-size, $border-width, $color) {
  $bg-size: $dash-size + $gap-size;
  background-image:
    linear-gradient(to right, $color $dash-size, transparent $dash-size),
    linear-gradient(to bottom, $color $dash-size, transparent $dash-size),
    linear-gradient(to right, $color $dash-size, transparent $dash-size),
    linear-gradient(to bottom, $color $dash-size, transparent $dash-size);

  background-position:
    top left,
    top right,
    bottom left,
    top left;

  background-size:
    $bg-size $border-width,
    $border-width $bg-size,
    $bg-size $border-width,
    $border-width $bg-size;

  background-repeat: repeat-x, repeat-y, repeat-x, repeat-y;
}

@mixin revision-style-box($revisionColor, $borderThickness) {
  box-sizing: border-box;
  $revisionBackgroundColor: color-mix(
    in display-p3,
    $revisionColor 40%,
    transparent
  );
  $revisionDarkerColor: $revisionColor;
  mat-icon {
    color: $revisionDarkerColor;
  }
  &.style-normal {
    background-color: $revisionBackgroundColor;
    border: $borderThickness solid $revisionDarkerColor;
  }
  &.style-partial-info {
    $stripeBrighter: color-mix(
      in display-p3,
      $revisionBackgroundColor 50%,
      transparent
    );
    background-image: repeating-linear-gradient(
      45deg,
      $stripeBrighter,
      $stripeBrighter 5px,
      $revisionBackgroundColor 5px,
      $revisionBackgroundColor 10px
    );
    border: $borderThickness solid $revisionDarkerColor;
  }
  &.style-deleted {
    background-color: $revisionBackgroundColor;
    @include dashed-border(2px, 2px, $borderThickness, $revisionDarkerColor);
  }
}

:host {
  display: inline-block;
}

.header-content {
  display: flex;
  align-items: center;
  gap: 5px;
}

.container {
  pointer-events: all;
  @include mat.button-toggle-overrides(
    (
      height: 10px,
      label-text-line-height: 10px,
    )
  );
  @include mat.expansion-overrides(
    (
      header-text-line-height: 20px,
      header-text-size: 14px,
      header-collapsed-state-height: 30px,
      header-expanded-state-height: 30px,
    )
  );
}

.timeline-type {
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 5px 0 5px 0;
  border-bottom: 1px solid lightgray;
  margin-bottom: 5px;
  .label-container {
    display: flex;
    align-items: center;
    gap: 5px;
    mat-icon {
      @include common.adjust-mat-icon-size(18px);
    }
    .label {
      color: var(--timeline-type-color);
      background-color: var(--timeline-type-background-color);
      padding: 0 5px;
      border-radius: 5px;
    }
  }
  .hint-container {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 12px;
    color: dimgray;
    mat-icon {
      @include common.adjust-mat-icon-size(14px);
    }
  }
}

.legend-type-title {
  display: flex;
  align-items: center;
  gap: 5px;
  color: $text-color-primary;
  font-weight: $font-weight-semibold;
}

.legend-container {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 0 0 0;
}

.toggle-button-container {
  display: flex;
  justify-content: center;
}

.revision-rect {
  $size: 30px;
  width: $size;
  height: $size;
  @include revision-style-box(var(--revision-color), 3px);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--revision-color);
  mat-icon {
    @include common.adjust-mat-icon-size(16px);
  }
}

.event-rect {
  $size: 10px;
  width: $size;
  height: $size;
  transform: rotate(45deg);
  margin: 0 10px 0 0;
  border: 3px solid var(--event-color);
  background: linear-gradient(135deg, transparent 40%, var(--event-color) 40%);
}

.severity-info {
  margin: 5px 0 0 0;
  color: $text-color-primary;
  font-weight: $font-weight-light;
}

.empty-legend-message {
  height: 150px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: $text-color-primary;
  gap: 5px;
  font-weight: $font-weight-light;
}

.empty-legend-message-title {
  display: flex;
  align-items: center;
  gap: 5px;
  font-weight: $font-weight-semibold;
}
