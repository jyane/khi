/**
 * Copyright 2026 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@use "sass:map";
@use "sass:color";
@use "../../common.scss" as common;
@use "@angular/material" as mat;
@use "../../generated" as gen;

:host {
  display: block;
}

$tint-base-color: mat.m2-get-color-from-palette(mat.$m2-green-palette, 50);
$tint-border-color: mat.m2-get-color-from-palette(mat.$m2-green-palette, 600);

$kind-base-color: rgba(63, 81, 181, 1);
$kind-style: (
  "height": 25px,
  "background-color": $kind-base-color,
  "font-color": white,
  "sub-label-color": color.adjust($kind-base-color, $lightness: 40%),
  "legend-background": color.adjust($kind-base-color, $lightness: 20%),
  "font-weight": 400,
  "left-padding": 5px,
);

$namespace-base-color: rgba(100, 100, 100, 1);
$namespace-style: (
  "height": 25px,
  "background-color": $namespace-base-color,
  "font-color": white,
  "sub-label-color": transparent,
  "legend-background": color.adjust($namespace-base-color, $lightness: 20%),
  "font-weight": 400,
  "left-padding": 5px,
);

$name-style: (
  "height": 30px,
  "background-color": rgba(230, 230, 230, 1),
  "font-color": black,
  "sub-label-color": transparent,
  "legend-background": transparent,
  "font-weight": 400,
  "left-padding": 10px,
);

$subresource-style: (
  "height": 22px,
  "background-color": rgba(255, 255, 255, 1),
  "font-color": black,
  "sub-label-color": transparent,
  "legend-background": transparent,
  "font-weight": 400,
  "left-padding": 10px,
);

.container {
  height: 100%;
}

@mixin itemContainerStyle($style) {
  height: map.get($style, "height");
  background-color: map.get($style, "background-color");
  color: map.get($style, "font-color");
  padding-left: map.get($style, "left-padding");
  font-weight: map.get($style, "font-weight");
  border-left: 5px dashed transparent;
  .index {
    .sub-label {
      color: map.get($style, "sub-label-color");
    }
  }
  .legend {
    background-color: map.get($style, "legend-background");
    color: map.get($style, "background-color");
  }
  &.selected {
    background-color: color.mix(
      map.get($style, "background-color"),
      color.adjust($tint-base-color, $lightness: -30%),
      60%
    );
    border-left: 5px solid $tint-border-color;
    .main-name {
      font-weight: 800;
    }
  }
  &.children-of-selected {
    background-color: color.mix(
      map.get($style, "background-color"),
      $tint-base-color,
      60%
    );
    border-left: 5px solid color.adjust($tint-border-color, $lightness: 30%);
    .main-name {
      font-weight: 800;
    }
  }
  &.hovered {
    background-color: color.mix(
      map.get($style, "background-color"),
      $tint-base-color,
      40%
    );
    font-weight: map.get($style, "font-weight") * 1.1;
    .main-name {
      font-weight: 600;
    }
  }
}

.index-container {
  box-sizing: border-box;
  display: flex;
  align-items: center;
  overflow: hidden;
  position: relative;
  min-width: 0;
  &.is-next-children {
    box-shadow: 0px 1px 1px 0px rgba(0, 0, 0, 0.4);
  }
  &:not(.is-next-children) {
    border-bottom: 1px solid rgba(0, 0, 0, 0.35);
  }

  .index {
    margin: 0px;
    flex: 1 1 auto;
    text-wrap: nowrap;
    overflow: hidden;
    display: flex;
    align-items: center;
    .main-name {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .relationship-label {
      @include gen.parent-relationship-label-styles;
      padding: 1px 3px;
      border-radius: 3px;
      margin-right: 5px;
      font-size: 12px;
    }
    .sub-label {
      font-size: 12px;
      font-weight: 400;
      margin-left: 5px;
    }
  }
  .legend {
    margin: 0 0 0 20px;
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    gap: 0px 5px;
    padding: 0px 10px;
    border-radius: 15px;
    white-space: nowrap;
    user-select: none;
    box-shadow: 0px 0px 2px 0px rgba(0, 0, 0, 0.4) inset;
    mat-icon {
      @include common.adjust-mat-icon-size(16px);
    }
  }
  &.kind {
    @include itemContainerStyle($kind-style);
  }
  &.namespace {
    @include itemContainerStyle($namespace-style);
  }
  &.name {
    @include itemContainerStyle($name-style);
  }
  &.subresource {
    @include itemContainerStyle($subresource-style);
  }
}
